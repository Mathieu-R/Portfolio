{"version":3,"file":"bundle.js","sources":["../../scripts/utils/utils.js","../../scripts/utils/toast.js","../../scripts/sw-install.js","../../scripts/components/sidenav.js","../../scripts/app.js"],"sourcesContent":["export function rafPromise() {\n  return new Promise(resolve => requestAnimationFrame(resolve));\n};\n\nexport function transitionEndPromise(el) {\n  return new Promise(resolve => {\n    const te = _ => {\n      el.removeEventListener('transitionend', te);\n      resolve();\n    }\n    el.addEventListener('transitionend', te);\n  });\n};\n\nexport function loadScript(url) {\n  return new Promise((resolve, reject) => {\n    const script = document.createElement('script');\n    script.src = url;\n    script.setAttribute('async', true);\n    script.onload = resolve;\n    script.onerror = reject;\n    document.body.appendChild(script);\n  });\n}\n","class Toast {\n  static Push(message) {\n    const container = document.querySelector('.toast-container');\n    const toast = document.createElement('div');\n    const toastContent = document.createElement('p');\n    toast.classList.add('toast');\n    toastContent.classList.add('toast-content');\n    toastContent.textContent = message;\n\n    container.appendChild(toast);\n    toast.appendChild(toastContent);\n\n    setTimeout(() => toast.classList.add('hide'), 3000);\n    toast.addEventListener('transitionend', evt => evt.target.parentNode.removeChild(evt.target));\n  }\n}\n\nexport default Toast;\n","import Toast from './utils/toast.js';\n\nexport function serviceWorkerInstall() {\n  if (!('serviceWorker' in navigator)) {\n    return;\n  }\n\n  navigator.serviceWorker.onmessage = evt => {\n    if (evt.data.type === 'version') {\n      console.log(`Service Worker updated to version ${evt.data.version}`);\n      Toast.Push('Portfolio updated. Refresh to get the new version.');\n      return;\n    }\n\n    if (evt.data.type === 'cached') {\n      Toast.Push('Portfolio cached. Future visit will work offline !');\n      return;\n    }\n  };\n\n  navigator.serviceWorker.register('/sw.js', {'scope': '/'})\n    .then(reg => {\n      reg.onupdatefound = evt => {\n        console.log('A new service worker has been found, installing...');\n\n        reg.installing.onstatechange = evt => {\n          // as the service worker is installed, we can push the message\n          if (evt.target.state === 'activated') {\n            reg.active.postMessage('version');\n          }\n          console.log(`Service Worker ${evt.target.state}`)\n        }\n      }\n    })\n    .catch(error => console.warn(error));\n}\n","class sideNav {\n  constructor() {\n\n  }\n\n  static close() {\n    document.querySelector('#toggle_nav').checked = false;\n  }\n}\n\nexport default sideNav;\n","import {loadScript} from './utils/utils.js';\nimport {serviceWorkerInstall} from './sw-install.js';\nimport Toast from './utils/toast.js';\nimport sideNav from './components/sidenav.js';\n\nclass App {\n  constructor() {\n    this.currentPath = window.location.pathname;\n    this.links = Array.from(document.querySelectorAll('.nav-link'));\n    this.navLinks = Array.from(document.querySelectorAll('.nav-content-link'));\n    this.pageContent = document.querySelector('.content');\n    this.slideUpLinks = ['/activities', '/projects', '/learning'];\n\n    this.onClickLinks = this.onClickLinks.bind(this);\n    this.onChanged = this.onChanged.bind(this);\n    this.loadView = this.loadView.bind(this);\n    this.swapContent = this.swapContent.bind(this);\n    this.hideAreas = this.hideAreas.bind(this);\n    this.slideBackUp = this.slideBackUp.bind(this);\n\n    serviceWorkerInstall();\n    this.initCustomElements();\n    this.addEventListeners();\n  }\n\n  initCustomElements () {\n    if (!('customElements' in window)) {\n      loadScript('/static/js/third_party/webcomponents-lite.js').then(_ => {\n        console.log('custom-elements polyfill added.');\n      });\n    }\n  }\n\n  loadView(url) {\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.open('GET', url, 'true');\n      xhr.onload = evt => {\n        const newView = evt.target.response;\n        resolve(newView);\n      }\n      xhr.onerror = reject;\n      xhr.responseType = 'document';\n      xhr.send();\n    });\n  }\n\n  swapContent(view, url) {\n    this.hideAreas(url).then(_ => {\n      console.log('hidden')\n      this.pageContent.removeEventListener('transitionend', this.onSwapTransitionEnd);\n\n      const currentMasthead = document.querySelector('.masthead');\n      const currentContent = document.querySelector('.content');\n\n      const newMasthead = view.querySelector('.masthead');\n      const newContent = view.querySelector('.content');\n\n      // TODO: rework this code\n      if (newMasthead) {\n        if (currentMasthead) {\n          currentMasthead.innerHTML = newMasthead.innerHTML;\n          currentMasthead.className = newMasthead.className;\n        } else {\n          document.body.insertBefore(newMasthead, currentContent);\n        }\n      } else if (!newMasthead && currentMasthead) {\n        document.body.removeChild(currentMasthead);\n      }\n\n      currentContent.innerHTML = newContent.innerHTML;\n      currentContent.className = newContent.className;\n\n      if (this.slideUpLinks.includes(url)) {\n        currentContent.classList.add('slide-down');\n        currentContent.style.willChange = 'transform';\n      }\n\n      // double rAF\n      requestAnimationFrame(_ => {\n        requestAnimationFrame(_ => {\n          if (this.slideUpLinks.includes(url)) {\n            this.slideBackUp().then(_ => {\n              this.pageContent.style.transition = '';\n              this.pageContent.style.willChange = '';\n            });\n          }\n          document.body.classList.remove('hide');\n        });\n      });\n    });\n  }\n\n  slideBackUp() {\n    return new Promise((resolve, reject) => {\n      this.pageContent.style.transition = 'opacity .3s cubic-bezier(0,0,0.3,1), transform .5s cubic-bezier(0,0,0.3,1)'\n      this.pageContent.addEventListener('transitionend', resolve);\n      this.pageContent.classList.remove('slide-down')\n    });\n  }\n\n  hideAreas(url) {\n    return new Promise((resolve, reject) => {\n      this.pageContent.addEventListener('transitionend', resolve);\n      document.body.classList.add('hide');\n    });\n  }\n\n  highlightCurrentLink(url) {\n    this.navLinks.forEach(navLink => {\n      navLink.classList.remove('nav-content-link__active');\n      if (new URL(navLink.href).pathname === url) {\n        navLink.classList.add('nav-content-link__active');\n      }\n    });\n  }\n\n  onChanged() {\n    this.newPath = window.location.pathname;\n    this.currentPath = this.newPath;\n\n    sideNav.close();\n    this.highlightCurrentLink(this.newPath);\n    this.loadView(this.newPath)\n      .then(view => this.swapContent(view, this.newPath))\n      .catch(error => console.warn(error));\n  }\n\n  onClickLinks(evt) {\n    evt.preventDefault();\n    if (new URL(evt.target.href).pathname === window.location.pathname) {\n      return;\n    }\n    history.pushState(null, null, evt.target.href);\n    this.onChanged();\n  }\n\n  addEventListeners() {\n    this.links.forEach(link => link.addEventListener('click', this.onClickLinks));\n    window.addEventListener('popstate', this.onChanged);\n  }\n}\n\nwindow.addEventListener('load', _ => new App());\n"],"names":["loadScript","url","Promise","resolve","reject","script","document","createElement","src","setAttribute","onload","onerror","body","appendChild","Toast","Push","message","container","querySelector","toast","toastContent","classList","add","textContent","addEventListener","evt","target","parentNode","removeChild","serviceWorkerInstall","navigator","serviceWorker","onmessage","data","type","log","version","register","then","reg","onupdatefound","installing","onstatechange","state","active","postMessage","catch","error","console","warn","sideNav","close","checked","App","currentPath","window","location","pathname","links","Array","from","querySelectorAll","navLinks","pageContent","slideUpLinks","onClickLinks","bind","onChanged","loadView","swapContent","hideAreas","slideBackUp","initCustomElements","addEventListeners","_","xhr","XMLHttpRequest","open","newView","response","responseType","send","view","removeEventListener","onSwapTransitionEnd","currentMasthead","currentContent","newMasthead","newContent","innerHTML","className","insertBefore","includes","style","willChange","transition","remove","forEach","navLink","URL","href","newPath","highlightCurrentLink","preventDefault","pushState","link"],"mappings":"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"}