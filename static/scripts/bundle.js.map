{"version":3,"file":"bundle.js","sources":["../../scripts/utils/utils.js","../../scripts/toast.js","../../scripts/sw-install.js","../../scripts/app.js"],"sourcesContent":["export function rafPromise() {\n  return new Promise(resolve => requestAnimationFrame(resolve));\n};\n\nexport function transitionEndPromise(el) {\n  return new Promise(resolve => {\n    const te = _ => {\n      el.removeEventListener('transitionend', te);\n      resolve();\n    }\n    el.addEventListener('transitionend', te);\n  });\n};\n\nexport function loadStyle(url) {\n  fetch(url)\n    .then(response => response.text())\n    .then(style => {\n      const link = document.createElement('link');\n      link.href = url;\n      document.head.appendChild(link);\n  });\n};\n\nexport function loadScript(url) {\n  return new Promise((resolve, reject) => {\n    const script = document.createElement('script');\n    script.src = url;\n    script.setAttribute('async', true);\n    script.onload = resolve;\n    script.onerror = reject;\n    document.body.appendChild(script);\n  });\n}\n\n","class Toast {\n  static Push(message) {\n    const container = document.querySelector('.toast-container');\n    const toast = document.createElement('div');\n    const toastContent = document.createElement('p');\n    toast.classList.add('toast');\n    toastContent.classList.add('toast-content');\n    toastContent.textContent = message;\n\n    container.appendChild(toast);\n    toast.appendChild(toastContent);\n\n    setTimeout(() => toast.classList.add('hide'), 3000);\n    toast.addEventListener('transitionend', evt => evt.target.parentNode.removeChild(evt.target));\n  }\n}\n\nexport default Toast;\n","import Toast from './toast.js';\n\nexport function serviceWorkerInstall() {\n  if (!('serviceWorker' in navigator)) {\n    return;\n  }\n\n  navigator.serviceWorker.onmessage = evt => {\n    if (evt.data.type === 'version') {\n      console.log(`Service Worker updated to version ${evt.data.version}`);\n      Toast.Push('Portfolio updated. Refresh to get the new version.');\n      return;\n    }\n\n    if (evt.data.type === 'cached') {\n      Toast.Push('Portfolio cached. Future visit will work offline !');\n      return;\n    }\n  };\n\n  navigator.serviceWorker.register('/sw.js', {'scope': '/'})\n    .then(reg => {\n      reg.onupdatefound = evt => {\n        console.log('A new service worker has been found, installing...');\n\n        reg.installing.onstatechange = evt => {\n          // as the service worker is installed, we can push the message\n          if (evt.target.state === 'activated') {\n            reg.active.postMessage('version');\n          }\n          console.log(`Service Worker ${evt.target.state}`)\n        }\n      }\n    })\n    .catch(error => console.warn(error));\n}\n","import {loadScript} from './utils/utils.js';\nimport {serviceWorkerInstall} from './sw-install.js';\nimport Toast from './toast.js';\n\nclass App {\n  constructor() {\n    this.currentPath = window.location.pathname;\n    this.links = Array.from(document.querySelectorAll('.nav-link'));\n    console.log(this.links);\n\n    this.onChanged = this.onChanged.bind(this);\n    this.loadView = this.loadView.bind(this);\n\n    serviceWorkerInstall();\n    this.initCustomElements();\n    this.addEventListeners();\n  }\n\n  initCustomElements () {\n    if (!('customElements' in window)) {\n      loadScript('/static/js/third_party/webcomponents-lite.js').then(_ => {\n        console.log('custom-elements polyfill added.');\n      });\n    }\n  }\n\n  loadView(url) {\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.open('GET', url, 'true');\n      xhr.onload = evt => {\n        const newView = evt.target.response;\n        resolve(newView);\n      }\n      xhr.onerror = reject;\n      xhr.responseType = 'document';\n      xhr.send();\n    });\n  }\n\n  swapContent(view) {\n    console.log(view);\n    const currentMasthead = document.querySelector('.masthead');\n    const currentContent = document.querySelector('.content');\n\n    const newMasthead = view.querySelector('.masthead');\n    const newContent = view.querySelector('.content');\n\n    if (newMasthead) {\n      currentMasthead.innerHTML = newMasthead.innerHTML;\n    }\n\n    currentContent.innerHTML = newContent.innerHTML;\n    return;\n  }\n\n  onChanged(evt) {\n    evt.preventDefault();\n    this.currentPath = window.location.pathname;\n    const newPath = evt.target.getAttribute('href');\n\n    if (this.currentPath === newPath) {\n      return;\n    }\n\n    history.pushState(null, null, newPath);\n    this.loadView(newPath)\n      .then(view => this.swapContent(view))\n      .catch(error => console.warn(error));\n  }\n\n  addEventListeners() {\n    this.links.forEach(link => link.addEventListener('click', this.onChanged));\n    window.addEventListener('popstate', this.onChanged);\n  }\n}\n\nwindow.addEventListener('load', _ => new App());\n"],"names":["loadScript","url","Promise","resolve","reject","script","document","createElement","src","setAttribute","onload","onerror","body","appendChild","Toast","Push","message","container","querySelector","toast","toastContent","classList","add","textContent","addEventListener","evt","target","parentNode","removeChild","serviceWorkerInstall","navigator","serviceWorker","onmessage","data","type","log","version","register","then","reg","onupdatefound","installing","onstatechange","state","active","postMessage","catch","error","console","warn","App","currentPath","window","location","pathname","links","Array","from","querySelectorAll","onChanged","bind","loadView","initCustomElements","addEventListeners","_","xhr","XMLHttpRequest","open","newView","response","responseType","send","view","currentMasthead","currentContent","newMasthead","newContent","innerHTML","preventDefault","newPath","getAttribute","pushState","swapContent","forEach","link"],"mappings":"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"}